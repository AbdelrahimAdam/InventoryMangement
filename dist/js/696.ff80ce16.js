"use strict";(self["webpackChunkmonofia_perfume_inventory"]=self["webpackChunkmonofia_perfume_inventory"]||[]).push([[696],{22:function(e,t,r){r.d(t,{A:function(){return te}});var a=r(641),s=r(33),o=r(751);const l={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},n={class:"bg-white rounded-lg w-full max-w-2xl rtl max-h-[90vh] overflow-y-auto"},d={class:"flex justify-between items-center p-6 border-b border-gray-200"},i={class:"text-xl font-semibold text-gray-800"},u={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},c=["readonly"],g={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},m={class:"relative inline-flex items-center cursor-pointer"},p={class:"mr-3 text-sm font-medium text-gray-700"},k={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},x=["value","onUpdate:modelValue","disabled"],h={class:"flex w-full items-center justify-between"},v={class:"flex items-center"},b={class:"text-sm"},y={class:"font-medium text-gray-900"},f={class:"text-gray-500 text-xs mt-1"},w={key:0,class:"h-5 w-5 text-indigo-600",viewBox:"0 0 20 20",fill:"currentColor"},L={key:0,class:"text-sm text-gray-500 mt-2"},C={key:0},_={class:"flex gap-3"},E={key:1},M={key:0,class:"text-center py-4"},X={key:1,class:"space-y-3"},U={class:"flex items-center justify-between mb-2"},j={class:"text-sm text-gray-600"},W={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},D={class:"flex items-center h-5"},P=["value"],A={class:"mr-3 text-sm"},S={class:"font-medium text-gray-900"},R={class:"text-gray-500 text-xs mt-1"},B={key:2,class:"text-center py-4 border border-gray-200 rounded-lg"},K={key:3,class:"text-red-500 text-sm mt-2"},I={key:2,class:"bg-gray-50 border border-gray-200 rounded-lg p-4"},z={class:"text-sm text-gray-600 space-y-1"},V={key:3,class:"bg-red-50 border border-red-200 rounded-md p-4"},F={class:"text-sm text-red-700 list-disc pr-5 space-y-1"},Q={key:4,class:"bg-red-50 border border-red-200 rounded-md p-4"},T={class:"text-sm text-red-700"},$={class:"flex gap-3 pt-6 border-t border-gray-200"},H=["disabled"],O={key:0,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},q={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function J(e,t,r,J,N,Z){return r.isOpen?((0,a.uX)(),(0,a.CE)("div",l,[(0,a.Lk)("div",n,[(0,a.Lk)("div",d,[(0,a.Lk)("h2",i,(0,s.v_)(r.user?"تعديل المستخدم":"إضافة مستخدم جديد"),1),(0,a.Lk)("button",{onClick:t[0]||(t[0]=t=>e.$emit("close")),class:"p-1 hover:bg-gray-100 rounded transition-colors duration-200"},[...t[11]||(t[11]=[(0,a.Lk)("svg",{class:"w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),(0,a.Lk)("form",{onSubmit:t[10]||(t[10]=(0,o.D$)((...e)=>J.handleSubmit&&J.handleSubmit(...e),["prevent"])),class:"p-6 space-y-6"},[(0,a.Lk)("div",u,[(0,a.Lk)("div",null,[t[12]||(t[12]=(0,a.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[(0,a.eW)(" الاسم الكامل "),(0,a.Lk)("span",{class:"text-red-500"},"*")],-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",required:"","onUpdate:modelValue":t[1]||(t[1]=e=>J.formData.name=e),class:"w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-colors duration-200",placeholder:"أدخل الاسم الكامل"},null,512),[[o.Jo,J.formData.name]])]),(0,a.Lk)("div",null,[t[13]||(t[13]=(0,a.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[(0,a.eW)(" البريد الإلكتروني "),(0,a.Lk)("span",{class:"text-red-500"},"*")],-1)),(0,a.bo)((0,a.Lk)("input",{type:"email",required:"","onUpdate:modelValue":t[2]||(t[2]=e=>J.formData.email=e),readonly:!!r.user,class:(0,s.C4)(["w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-colors duration-200",{"bg-gray-100":!!r.user}]),placeholder:"example@company.com"},null,10,c),[[o.Jo,J.formData.email]])])]),(0,a.Lk)("div",g,[(0,a.Lk)("div",null,[t[14]||(t[14]=(0,a.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," رقم الهاتف ",-1)),(0,a.bo)((0,a.Lk)("input",{type:"tel","onUpdate:modelValue":t[3]||(t[3]=e=>J.formData.phone=e),class:"w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-colors duration-200",placeholder:"01XXXXXXXXX"},null,512),[[o.Jo,J.formData.phone]])]),(0,a.Lk)("div",null,[t[16]||(t[16]=(0,a.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-3"},"حالة الحساب",-1)),(0,a.Lk)("label",m,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=e=>J.formData.is_active=e),class:"sr-only peer"},null,512),[[o.lH,J.formData.is_active]]),t[15]||(t[15]=(0,a.Lk)("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:right-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"},null,-1)),(0,a.Lk)("span",p,(0,s.v_)(J.formData.is_active?"نشط":"غير نشط"),1)])])]),(0,a.Lk)("div",null,[t[18]||(t[18]=(0,a.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[(0,a.eW)(" الدور "),(0,a.Lk)("span",{class:"text-red-500"},"*")],-1)),(0,a.Lk)("div",k,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(J.availableRoles,e=>((0,a.uX)(),(0,a.CE)("label",{key:e.value,class:(0,s.C4)(["relative flex cursor-pointer rounded-lg border p-4 focus:outline-none transition-colors duration-200",{"border-indigo-600 bg-indigo-50":J.formData.role===e.value,"border-gray-300 bg-white":J.formData.role!==e.value}])},[(0,a.bo)((0,a.Lk)("input",{type:"radio",value:e.value,"onUpdate:modelValue":e=>J.formData.role=e,disabled:"superadmin"===r.user?.role,class:"sr-only"},null,8,x),[[o.XL,J.formData.role]]),(0,a.Lk)("div",h,[(0,a.Lk)("div",v,[(0,a.Lk)("div",b,[(0,a.Lk)("div",y,(0,s.v_)(e.name),1),(0,a.Lk)("div",f,(0,s.v_)(e.description),1)])]),J.formData.role===e.value?((0,a.uX)(),(0,a.CE)("svg",w,[...t[17]||(t[17]=[(0,a.Lk)("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)])])):(0,a.Q3)("",!0)])],2))),128))]),"superadmin"===r.user?.role?((0,a.uX)(),(0,a.CE)("p",L," لا يمكن تغيير دور المشرف العام ")):(0,a.Q3)("",!0)]),r.user?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",C,[t[19]||(t[19]=(0,a.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[(0,a.eW)(" كلمة المرور "),(0,a.Lk)("span",{class:"text-red-500"},"*"),(0,a.Lk)("span",{class:"text-xs text-gray-500"},"(سيستخدمها المستخدم للدخول)")],-1)),(0,a.Lk)("div",_,[(0,a.bo)((0,a.Lk)("input",{type:"text",required:"","onUpdate:modelValue":t[5]||(t[5]=e=>J.formData.password=e),class:"flex-1 p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-colors duration-200",placeholder:"كلمة المرور المؤقتة"},null,512),[[o.Jo,J.formData.password]]),(0,a.Lk)("button",{type:"button",onClick:t[6]||(t[6]=(...e)=>J.generatePassword&&J.generatePassword(...e)),class:"px-4 py-3 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors duration-200 text-sm font-medium"}," توليد عشوائي ")]),t[20]||(t[20]=(0,a.Lk)("p",{class:"text-xs text-gray-500 mt-1"}," يجب أن تكون كلمة المرور 6 أحرف على الأقل ",-1))])),"warehouse_manager"===J.formData.role?((0,a.uX)(),(0,a.CE)("div",E,[t[23]||(t[23]=(0,a.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[(0,a.eW)(" المخازن المسموحة "),(0,a.Lk)("span",{class:"text-red-500"},"*"),(0,a.Lk)("span",{class:"text-xs text-gray-500 block mt-1"},"اختر المخازن التي يمكن للمستخدم الوصول إليها")],-1)),J.loadingWarehouses?((0,a.uX)(),(0,a.CE)("div",M,[...t[21]||(t[21]=[(0,a.Lk)("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-indigo-600 mx-auto"},null,-1),(0,a.Lk)("p",{class:"text-sm text-gray-500 mt-2"},"جاري تحميل المخازن...",-1)])])):((0,a.uX)(),(0,a.CE)("div",X,[(0,a.Lk)("div",U,[(0,a.Lk)("div",j,(0,s.v_)(J.primaryWarehouses.length)+" مخزن متاح ",1),(0,a.Lk)("button",{type:"button",onClick:t[7]||(t[7]=(...e)=>J.toggleAllWarehouses&&J.toggleAllWarehouses(...e)),class:"text-sm text-indigo-600 hover:text-indigo-800"},(0,s.v_)(J.formData.allowed_warehouses.length===J.primaryWarehouses.length?"إلغاء الكل":"اختيار الكل"),1)]),(0,a.Lk)("div",W,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(J.primaryWarehouses,e=>((0,a.uX)(),(0,a.CE)("label",{key:e.id,class:(0,s.C4)(["relative flex items-start p-3 border rounded-lg transition-colors duration-200",{"border-indigo-300 bg-indigo-50":J.formData.allowed_warehouses.includes(e.id),"border-gray-200 bg-white hover:bg-gray-50":!J.formData.allowed_warehouses.includes(e.id)}])},[(0,a.Lk)("div",D,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox",value:e.id,"onUpdate:modelValue":t[8]||(t[8]=e=>J.formData.allowed_warehouses=e),class:"h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"},null,8,P),[[o.lH,J.formData.allowed_warehouses]])]),(0,a.Lk)("div",A,[(0,a.Lk)("div",S,(0,s.v_)(e.name_ar),1),(0,a.Lk)("div",R,(0,s.v_)(e.name_en),1)])],2))),128))])])),J.loadingWarehouses||0!==J.primaryWarehouses.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",B,[...t[22]||(t[22]=[(0,a.Lk)("svg",{class:"mx-auto h-8 w-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})],-1),(0,a.Lk)("p",{class:"text-sm text-gray-500 mt-2"},"لا توجد مخازن متاحة",-1)])])),0===J.formData.allowed_warehouses.length&&J.primaryWarehouses.length>0?((0,a.uX)(),(0,a.CE)("p",K," يجب اختيار مخزن واحد على الأقل لمدير المخازن ")):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),J.formData.role?((0,a.uX)(),(0,a.CE)("div",I,[t[25]||(t[25]=(0,a.Lk)("h4",{class:"text-sm font-medium text-gray-900 mb-2"},"ملخص الصلاحيات:",-1)),(0,a.Lk)("ul",z,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(J.getRolePermissions(J.formData.role),e=>((0,a.uX)(),(0,a.CE)("li",{key:e,class:"flex items-center"},[t[24]||(t[24]=(0,a.Lk)("svg",{class:"h-4 w-4 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)),(0,a.eW)(" "+(0,s.v_)(e),1)]))),128))])])):(0,a.Q3)("",!0),J.validationErrors.length>0?((0,a.uX)(),(0,a.CE)("div",V,[t[26]||(t[26]=(0,a.Lk)("h4",{class:"text-sm font-medium text-red-800 mb-2"},"خطأ في التحقق:",-1)),(0,a.Lk)("ul",F,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(J.validationErrors,e=>((0,a.uX)(),(0,a.CE)("li",{key:e},(0,s.v_)(e),1))),128))])])):(0,a.Q3)("",!0),J.errorMessage?((0,a.uX)(),(0,a.CE)("div",Q,[(0,a.Lk)("p",T,(0,s.v_)(J.errorMessage),1)])):(0,a.Q3)("",!0),(0,a.Lk)("div",$,[(0,a.Lk)("button",{type:"button",onClick:t[9]||(t[9]=t=>e.$emit("close")),class:"flex-1 py-3 px-4 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors duration-200 font-medium"}," إلغاء "),(0,a.Lk)("button",{type:"submit",disabled:J.loading||!J.isFormValid,class:"flex-1 py-3 px-4 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200 font-medium flex items-center justify-center gap-2"},[J.loading?((0,a.uX)(),(0,a.CE)("svg",O,[...t[27]||(t[27]=[(0,a.Lk)("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),(0,a.Lk)("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):((0,a.uX)(),(0,a.CE)("svg",q,[...t[28]||(t[28]=[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])),(0,a.eW)(" "+(0,s.v_)(J.loading?"جاري الحفظ...":r.user?"تحديث":"إضافة"),1)],8,H)])],32)])])):(0,a.Q3)("",!0)}var N=r(953),Z=r(278),G={name:"UserModal",props:{isOpen:{type:Boolean,required:!0},user:{type:Object,default:null}},emits:["close","save"],setup(e,{emit:t}){const r=(0,Z.Pj)(),s=(0,N.KR)(!1),o=(0,N.KR)(!1),l=(0,N.KR)(""),n=(0,N.KR)([]),d=(0,N.KR)({name:"",email:"",role:"company_manager",is_active:!0,phone:"",allowed_warehouses:[],password:""}),i=(0,N.KR)([{value:"superadmin",name:"المشرف العام",description:"صلاحيات كاملة على النظام"},{value:"warehouse_manager",name:"مدير المخازن",description:"إدارة المخزون والحركات في المخازن المحددة"},{value:"company_manager",name:"مدير الشركة",description:"عرض التقارير والبيانات (قراءة فقط)"}]),u=(0,a.EW)(()=>{const e=r.state.warehouses||[];return e.filter(e=>"primary"===e.type)}),c=(0,a.EW)(()=>(n.value=[],d.value.name.trim()||n.value.push("الاسم الكامل مطلوب"),d.value.email.trim()?g(d.value.email)||n.value.push("صيغة البريد الإلكتروني غير صحيحة"):n.value.push("البريد الإلكتروني مطلوب"),d.value.role||n.value.push("الدور مطلوب"),e.user||d.value.password?!e.user&&d.value.password.length<6&&n.value.push("كلمة المرور يجب أن تكون 6 أحرف على الأقل"):n.value.push("كلمة المرور مطلوبة"),"warehouse_manager"===d.value.role&&0===d.value.allowed_warehouses.length&&n.value.push("يجب اختيار مخزن واحد على الأقل لمدير المخازن"),d.value.phone&&!m(d.value.phone)&&n.value.push("رقم الهاتف غير صحيح"),0===n.value.length)),g=e=>{const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return t.test(e)},m=e=>{const t=/^01[0-9]{9}$/;return t.test(e)},p=e=>{const t={superadmin:["الوصول الكامل إلى جميع المخازن","إدارة المستخدمين والأدوار","إنشاء وتعديل وحذف الأصناف","إدارة الحركات والنقل","تصدير التقارير والبيانات","إعدادات النظام"],warehouse_manager:["الوصول إلى المخازن المحددة فقط","إنشاء وتعديل الأصناف في المخازن المسموحة","إدارة الحركات والنقل بين المخازن المسموحة","عرض التقارير للمخازن المسموحة","تصدير بيانات المخازن المسموحة"],company_manager:["عرض جميع البيانات للقراءة فقط","تصفية البيانات والتقارير","تصدير التقارير والبيانات","لا يمكن التعديل أو الحذف"]};return t[e]||[]},k=()=>{const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*";let t="";for(let r=0;r<12;r++)t+=e.charAt(Math.floor(Math.random()*e.length));d.value.password=t},x=()=>{d.value.allowed_warehouses.length===u.value.length?d.value.allowed_warehouses=[]:d.value.allowed_warehouses=u.value.map(e=>e.id)},h=()=>{d.value={name:"",email:"",role:"company_manager",is_active:!0,phone:"",allowed_warehouses:[],password:""},l.value="",n.value=[]},v=async()=>{if(0===u.value.length){o.value=!0;try{await r.dispatch("loadWarehouses")}catch(e){console.error("Error loading warehouses:",e),l.value="خطأ في تحميل المخازن"}finally{o.value=!1}}},b=async()=>{if(c.value){s.value=!0,l.value="";try{const r={name:d.value.name.trim(),email:d.value.email.trim(),role:d.value.role,is_active:d.value.is_active,phone:d.value.phone.trim(),allowed_warehouses:"warehouse_manager"===d.value.role?d.value.allowed_warehouses:[],updated_at:new Date};e.user?(r.id=e.user.id,r.created_at=e.user.created_at):(r.created_at=new Date,r.password=d.value.password),t("save",r)}catch(r){console.error("Error in form submission:",r),l.value=r.message||"حدث خطأ أثناء حفظ المستخدم"}finally{s.value=!1}}};return(0,a.wB)(()=>e.isOpen,async t=>{t&&(h(),e.user||k(),await v(),e.user&&(d.value={name:e.user.name||"",email:e.user.email||"",role:e.user.role||"company_manager",is_active:!1!==e.user.is_active,phone:e.user.phone||"",allowed_warehouses:e.user.allowed_warehouses||[]}))}),(0,a.wB)(()=>d.value.role,e=>{"warehouse_manager"!==e&&(d.value.allowed_warehouses=[])}),(0,a.sV)(async()=>{await v()}),{loading:s,loadingWarehouses:o,errorMessage:l,validationErrors:n,formData:d,availableRoles:i,primaryWarehouses:u,isFormValid:c,getRolePermissions:p,generatePassword:k,toggleAllWarehouses:x,handleSubmit:b}}},Y=r(262);const ee=(0,Y.A)(G,[["render",J]]);var te=ee},315:function(e,t,r){r.r(t),r.d(t,{default:function(){return qe}});var a=r(641),s=r(33),o=r(751);const l={class:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-200"},n={class:"sticky top-0 z-50 bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700"},d={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},i={class:"flex justify-between items-center h-16"},u={class:"flex items-center space-x-4 space-x-reverse"},c={class:"flex items-center space-x-3 space-x-reverse"},g={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},m={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},p={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 hover:shadow-md transition-shadow duration-200"},k={class:"flex items-center"},x={class:"text-2xl font-bold text-gray-900 dark:text-white"},h={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 hover:shadow-md transition-shadow duration-200"},v={class:"flex items-center"},b={class:"text-2xl font-bold text-gray-900 dark:text-white"},y={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 hover:shadow-md transition-shadow duration-200"},f={class:"flex items-center"},w={class:"text-2xl font-bold text-gray-900 dark:text-white"},L={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 hover:shadow-md transition-shadow duration-200"},C={class:"flex items-center"},_={class:"text-lg font-bold text-gray-900 dark:text-white"},E={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-8"},M={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},X={class:"flex-1"},U={class:"relative"},j={class:"flex space-x-3 space-x-reverse"},W=["disabled"],D={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden"},P={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},A={class:"flex items-center justify-between"},S={class:"text-sm text-gray-500 dark:text-gray-400"},R={key:0,class:"p-8 text-center"},B={key:1,class:"p-8 text-center"},K={class:"text-red-700 dark:text-red-300 mb-4"},I={key:2,class:"p-8 text-center"},z={class:"text-gray-500 dark:text-gray-400 mb-4"},V={key:3,class:"overflow-x-auto"},F={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},Q={class:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800"},T={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white"},$={class:"px-6 py-4"},H={class:"flex items-center"},O={class:"h-10 w-10 rounded-full bg-gradient-to-r from-blue-500 to-purple-500 flex items-center justify-center ml-3"},q={class:"text-white font-medium text-sm"},J={class:"text-sm font-medium text-gray-900 dark:text-white"},N={key:0,class:"text-xs text-gray-500 dark:text-gray-400"},Z={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},G={class:"px-6 py-4 whitespace-nowrap"},Y={class:"px-6 py-4"},ee={class:"text-sm text-gray-900 dark:text-white max-w-xs truncate"},te={key:0},re={key:1,class:"text-gray-500 dark:text-gray-400"},ae={class:"px-6 py-4 whitespace-nowrap"},se={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},oe={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},le={class:"flex space-x-2 space-x-reverse"},ne=["onClick"],de=["onClick"],ie=["onClick","title"],ue={class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ce={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"},ge={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},me=["onClick"],pe={key:4,class:"flex items-center justify-between px-4 py-3 border-t border-gray-200 dark:border-gray-700"},ke={class:"text-sm text-gray-700 dark:text-gray-300"},xe={class:"font-medium"},he={class:"font-medium"},ve={class:"font-medium"},be={class:"flex space-x-2 space-x-reverse"},ye=["disabled"],fe={class:"flex space-x-1 space-x-reverse"},we=["onClick"],Le=["disabled"],Ce={key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"};function _e(e,t,r,_e,Ee,Me){const Xe=(0,a.g2)("router-link"),Ue=(0,a.g2)("AddUserModal"),je=(0,a.g2)("UserModal"),We=(0,a.g2)("ResetPasswordModal");return(0,a.uX)(),(0,a.CE)("div",l,[(0,a.Lk)("header",n,[(0,a.Lk)("div",d,[(0,a.Lk)("div",i,[(0,a.Lk)("div",u,[(0,a.bF)(Xe,{to:"/",class:"flex items-center space-x-2 space-x-reverse hover:opacity-80 transition-opacity"},{default:(0,a.k6)(()=>[...t[15]||(t[15]=[(0,a.Lk)("div",{class:"h-8 w-8 bg-gradient-to-r from-purple-600 to-indigo-600 rounded-lg flex items-center justify-center"},[(0,a.Lk)("span",{class:"text-white font-bold text-sm"},"م")],-1),(0,a.Lk)("div",null,[(0,a.Lk)("h1",{class:"text-lg font-bold text-gray-900 dark:text-white"},"إدارة المستخدمين"),(0,a.Lk)("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"نظام إدارة المخزون")],-1)])]),_:1})]),(0,a.Lk)("div",c,[(0,a.Lk)("button",{onClick:t[0]||(t[0]=e=>_e.showAddModal=!0),class:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white text-sm font-medium rounded-lg hover:from-blue-700 hover:to-indigo-700 transition-all duration-200 shadow-sm"},[...t[16]||(t[16]=[(0,a.Lk)("svg",{class:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),(0,a.eW)(" مستخدم جديد ",-1)])]),(0,a.bF)(Xe,{to:"/",class:"inline-flex items-center px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-sm font-medium rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-200"},{default:(0,a.k6)(()=>[...t[17]||(t[17]=[(0,a.eW)(" الرئيسية ",-1)])]),_:1})])])])]),(0,a.Lk)("main",g,[(0,a.Lk)("div",m,[(0,a.Lk)("div",p,[(0,a.Lk)("div",k,[t[19]||(t[19]=(0,a.Lk)("div",{class:"h-12 w-12 rounded-lg bg-blue-100 dark:bg-blue-900 flex items-center justify-center ml-4"},[(0,a.Lk)("svg",{class:"h-6 w-6 text-blue-600 dark:text-blue-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5 3.714a6 6 0 00-13 0"})])],-1)),(0,a.Lk)("div",null,[t[18]||(t[18]=(0,a.Lk)("p",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"إجمالي المستخدمين",-1)),(0,a.Lk)("p",x,(0,s.v_)(_e.formatNumber(_e.totalUsers)),1)])])]),(0,a.Lk)("div",h,[(0,a.Lk)("div",v,[t[21]||(t[21]=(0,a.Lk)("div",{class:"h-12 w-12 rounded-lg bg-green-100 dark:bg-green-900 flex items-center justify-center ml-4"},[(0,a.Lk)("svg",{class:"h-6 w-6 text-green-600 dark:text-green-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),(0,a.Lk)("div",null,[t[20]||(t[20]=(0,a.Lk)("p",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"نشطين",-1)),(0,a.Lk)("p",b,(0,s.v_)(_e.formatNumber(_e.activeUsers)),1)])])]),(0,a.Lk)("div",y,[(0,a.Lk)("div",f,[t[23]||(t[23]=(0,a.Lk)("div",{class:"h-12 w-12 rounded-lg bg-orange-100 dark:bg-orange-900 flex items-center justify-center ml-4"},[(0,a.Lk)("svg",{class:"h-6 w-6 text-orange-600 dark:text-orange-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),(0,a.Lk)("div",null,[t[22]||(t[22]=(0,a.Lk)("p",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"مديري المخازن",-1)),(0,a.Lk)("p",w,(0,s.v_)(_e.formatNumber(_e.warehouseManagers)),1)])])]),(0,a.Lk)("div",L,[(0,a.Lk)("div",C,[t[25]||(t[25]=(0,a.Lk)("div",{class:"h-12 w-12 rounded-lg bg-purple-100 dark:bg-purple-900 flex items-center justify-center ml-4"},[(0,a.Lk)("svg",{class:"h-6 w-6 text-purple-600 dark:text-purple-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5.121 17.804A7.968 7.968 0 015 16c0-4.418 3.582-8 8-8s8 3.582 8 8-3.582 8-8 8-8-3.582-8-8c0-1.104.188-2.169.535-3.164"})])],-1)),(0,a.Lk)("div",null,[t[24]||(t[24]=(0,a.Lk)("p",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"آخر تسجيل",-1)),(0,a.Lk)("p",_,(0,s.v_)(_e.lastLoginTime),1)])])])]),(0,a.Lk)("div",E,[(0,a.Lk)("div",M,[(0,a.Lk)("div",X,[(0,a.Lk)("div",U,[(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>_e.searchTerm=e),onInput:t[2]||(t[2]=(...e)=>_e.handleSearch&&_e.handleSearch(...e)),placeholder:"ابحث باسم المستخدم، البريد الإلكتروني، أو الدور...",class:"w-full pr-12 pl-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,544),[[o.Jo,_e.searchTerm]]),t[26]||(t[26]=(0,a.Lk)("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[(0,a.Lk)("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))])]),(0,a.Lk)("div",j,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>_e.roleFilter=e),onChange:t[4]||(t[4]=(...e)=>_e.handleFilter&&_e.handleFilter(...e)),class:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[...t[27]||(t[27]=[(0,a.Lk)("option",{value:""},"جميع الأدوار",-1),(0,a.Lk)("option",{value:"superadmin"},"المشرف العام",-1),(0,a.Lk)("option",{value:"warehouse_manager"},"مدير المخازن",-1),(0,a.Lk)("option",{value:"company_manager"},"مدير الشركة",-1)])],544),[[o.u1,_e.roleFilter]]),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>_e.statusFilter=e),onChange:t[6]||(t[6]=(...e)=>_e.handleFilter&&_e.handleFilter(...e)),class:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[...t[28]||(t[28]=[(0,a.Lk)("option",{value:""},"جميع الحالات",-1),(0,a.Lk)("option",{value:"active"},"نشيط",-1),(0,a.Lk)("option",{value:"inactive"},"غير نشيط",-1)])],544),[[o.u1,_e.statusFilter]]),(0,a.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>_e.refreshData&&_e.refreshData(...e)),class:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-200",disabled:_e.loading},[((0,a.uX)(),(0,a.CE)("svg",{class:(0,s.C4)(["w-5 h-5",_e.loading?"animate-spin":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[29]||(t[29]=[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2))],8,W)])])]),(0,a.Lk)("div",D,[(0,a.Lk)("div",P,[(0,a.Lk)("div",A,[t[30]||(t[30]=(0,a.Lk)("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"قائمة المستخدمين",-1)),(0,a.Lk)("div",S,(0,s.v_)(_e.formatNumber(_e.filteredUsers.length))+" مستخدم ",1)])]),_e.loading?((0,a.uX)(),(0,a.CE)("div",R,[...t[31]||(t[31]=[(0,a.Lk)("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"},null,-1),(0,a.Lk)("p",{class:"text-gray-700 dark:text-gray-300"},"جاري تحميل البيانات...",-1)])])):_e.error?((0,a.uX)(),(0,a.CE)("div",B,[t[32]||(t[32]=(0,a.Lk)("div",{class:"inline-flex items-center justify-center w-16 h-16 bg-red-100 dark:bg-red-900 rounded-full mb-4"},[(0,a.Lk)("svg",{class:"w-8 h-8 text-red-600 dark:text-red-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),(0,a.Lk)("p",K,(0,s.v_)(_e.error),1),(0,a.Lk)("button",{onClick:t[8]||(t[8]=(...e)=>_e.refreshData&&_e.refreshData(...e)),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200"}," إعادة المحاولة ")])):0===_e.filteredUsers.length?((0,a.uX)(),(0,a.CE)("div",I,[t[33]||(t[33]=(0,a.Lk)("div",{class:"inline-flex items-center justify-center w-16 h-16 bg-gray-100 dark:bg-gray-700 rounded-full mb-4"},[(0,a.Lk)("svg",{class:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})])],-1)),t[34]||(t[34]=(0,a.Lk)("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},"لا توجد مستخدمين",-1)),(0,a.Lk)("p",z,(0,s.v_)(_e.searchTerm?"لم يتم العثور على مستخدمين مطابقين للبحث":"لم يتم العثور على أي مستخدمين"),1),(0,a.Lk)("button",{onClick:t[9]||(t[9]=e=>_e.showAddModal=!0),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200"}," إضافة أول مستخدم ")])):((0,a.uX)(),(0,a.CE)("div",V,[(0,a.Lk)("table",F,[t[38]||(t[38]=(0,a.Lk)("thead",{class:"bg-gray-50 dark:bg-gray-800"},[(0,a.Lk)("tr",null,[(0,a.Lk)("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," # "),(0,a.Lk)("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," المستخدم "),(0,a.Lk)("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," البريد الإلكتروني "),(0,a.Lk)("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," الدور "),(0,a.Lk)("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," المخازن المسموحة "),(0,a.Lk)("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," الحالة "),(0,a.Lk)("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," آخر تسجيل "),(0,a.Lk)("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," الإجراءات ")])],-1)),(0,a.Lk)("tbody",Q,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(_e.paginatedUsers,(e,r)=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id,class:"hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors duration-150"},[(0,a.Lk)("td",T,(0,s.v_)(_e.startIndex+r+1),1),(0,a.Lk)("td",$,[(0,a.Lk)("div",H,[(0,a.Lk)("div",O,[(0,a.Lk)("span",q,(0,s.v_)(_e.getUserInitials(e.name)),1)]),(0,a.Lk)("div",null,[(0,a.Lk)("div",J,(0,s.v_)(e.name),1),e.phone?((0,a.uX)(),(0,a.CE)("div",N,(0,s.v_)(e.phone),1)):(0,a.Q3)("",!0)])])]),(0,a.Lk)("td",Z,(0,s.v_)(e.email),1),(0,a.Lk)("td",G,[(0,a.Lk)("span",{class:(0,s.C4)(_e.getRoleBadgeClass(e.role))},(0,s.v_)(_e.getRoleText(e.role)),3)]),(0,a.Lk)("td",Y,[(0,a.Lk)("div",ee,[e.allowed_warehouses&&e.allowed_warehouses.length>0?((0,a.uX)(),(0,a.CE)("span",te,(0,s.v_)(e.allowed_warehouses.length)+" مخزن ",1)):((0,a.uX)(),(0,a.CE)("span",re,"غير محدد"))])]),(0,a.Lk)("td",ae,[(0,a.Lk)("span",{class:(0,s.C4)(_e.getStatusBadgeClass(e))},(0,s.v_)(_e.getStatusText(e)),3)]),(0,a.Lk)("td",se,(0,s.v_)(_e.formatDate(e.last_login)||"لم يسجل دخول"),1),(0,a.Lk)("td",oe,[(0,a.Lk)("div",le,[(0,a.Lk)("button",{onClick:t=>_e.editUser(e),class:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",title:"تعديل"},[...t[35]||(t[35]=[(0,a.Lk)("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,ne),(0,a.Lk)("button",{onClick:t=>_e.resetPassword(e),class:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300",title:"إعادة تعيين كلمة المرور"},[...t[36]||(t[36]=[(0,a.Lk)("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 15v2m0 0v2m0-2h2m-2 0H9m3-6a3 3 0 110-6 3 3 0 010 6zm2 7a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])],8,de),e.id!==_e.currentUserId?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t=>_e.toggleUserStatus(e),class:(0,s.C4)(_e.getStatusButtonClass(e)),title:e.is_active?"تعطيل":"تفعيل"},[((0,a.uX)(),(0,a.CE)("svg",ue,[e.is_active?((0,a.uX)(),(0,a.CE)("path",ce)):((0,a.uX)(),(0,a.CE)("path",ge))]))],10,ie)):(0,a.Q3)("",!0),e.id!==_e.currentUserId&&"superadmin"!==e.role?((0,a.uX)(),(0,a.CE)("button",{key:1,onClick:t=>_e.deleteUser(e),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",title:"حذف"},[...t[37]||(t[37]=[(0,a.Lk)("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,me)):(0,a.Q3)("",!0)])])]))),128))])])])),_e.filteredUsers.length>0&&_e.totalPages>1?((0,a.uX)(),(0,a.CE)("div",pe,[(0,a.Lk)("div",ke,[t[39]||(t[39]=(0,a.eW)(" عرض ",-1)),(0,a.Lk)("span",xe,(0,s.v_)(_e.startIndex+1),1),t[40]||(t[40]=(0,a.eW)(" إلى ",-1)),(0,a.Lk)("span",he,(0,s.v_)(Math.min(_e.endIndex,_e.filteredUsers.length)),1),t[41]||(t[41]=(0,a.eW)(" من ",-1)),(0,a.Lk)("span",ve,(0,s.v_)(_e.formatNumber(_e.filteredUsers.length)),1),t[42]||(t[42]=(0,a.eW)(" نتيجة ",-1))]),(0,a.Lk)("div",be,[(0,a.Lk)("button",{onClick:t[10]||(t[10]=(...e)=>_e.prevPage&&_e.prevPage(...e)),disabled:1===_e.currentPage,class:"px-3 py-1 rounded-lg border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200"}," السابق ",8,ye),(0,a.Lk)("div",fe,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(_e.visiblePages,e=>((0,a.uX)(),(0,a.CE)("button",{key:e,onClick:t=>_e.goToPage(e),class:(0,s.C4)(["w-8 h-8 rounded-lg flex items-center justify-center transition-colors duration-200",e===_e.currentPage?"bg-blue-600 text-white":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"])},(0,s.v_)(e),11,we))),128))]),(0,a.Lk)("button",{onClick:t[11]||(t[11]=(...e)=>_e.nextPage&&_e.nextPage(...e)),disabled:_e.currentPage===_e.totalPages,class:"px-3 py-1 rounded-lg border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200"}," التالي ",8,Le)])])):(0,a.Q3)("",!0)])]),_e.showAddModal?((0,a.uX)(),(0,a.Wv)(Ue,{key:0,show:_e.showAddModal,onClose:t[12]||(t[12]=e=>_e.showAddModal=!1),onSaved:_e.handleUserAdded},null,8,["show","onSaved"])):(0,a.Q3)("",!0),_e.showEditModal?((0,a.uX)(),(0,a.Wv)(je,{key:1,show:_e.showEditModal,"user-id":_e.selectedUserId,onClose:t[13]||(t[13]=e=>_e.showEditModal=!1),onSaved:_e.handleUserUpdated},null,8,["show","user-id","onSaved"])):(0,a.Q3)("",!0),_e.showResetPasswordModal?((0,a.uX)(),(0,a.Wv)(We,{key:2,show:_e.showResetPasswordModal,"user-id":_e.selectedUserId,onClose:t[14]||(t[14]=e=>_e.showResetPasswordModal=!1),onSaved:_e.handlePasswordReset},null,8,["show","user-id","onSaved"])):(0,a.Q3)("",!0),_e.operationLoading?((0,a.uX)(),(0,a.CE)("div",Ce,[...t[43]||(t[43]=[(0,a.Lk)("div",{class:"bg-white dark:bg-gray-800 rounded-xl p-8 flex flex-col items-center shadow-xl"},[(0,a.Lk)("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mb-4"}),(0,a.Lk)("p",{class:"text-gray-700 dark:text-gray-300 font-medium"},"جاري المعالجة..."),(0,a.Lk)("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-2"},"يرجى الانتظار")],-1)])])):(0,a.Q3)("",!0)])}var Ee=r(953),Me=r(278);const Xe={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},Ue={class:"bg-white rounded-2xl shadow-xl w-full max-w-md rtl"},je={class:"px-6 py-4 border-b border-gray-200"},We={class:"flex items-center justify-between"},De={class:"flex items-center space-x-2 space-x-reverse"},Pe={key:0,class:"bg-red-50 border border-red-200 rounded-lg p-3"},Ae={class:"text-sm text-red-600"},Se={class:"flex space-x-3 space-x-reverse pt-4"},Re=["disabled"],Be={key:0},Ke={key:1};function Ie(e,t,r,l,n,d){return r.isOpen?((0,a.uX)(),(0,a.CE)("div",Xe,[(0,a.Lk)("div",Ue,[(0,a.Lk)("div",je,[(0,a.Lk)("div",We,[t[10]||(t[10]=(0,a.Lk)("h3",{class:"text-lg font-semibold text-gray-900"},"إضافة مستخدم جديد",-1)),(0,a.Lk)("button",{onClick:t[0]||(t[0]=t=>e.$emit("close")),class:"text-gray-400 hover:text-gray-600 transition-colors duration-200"},[...t[9]||(t[9]=[(0,a.Lk)("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),(0,a.Lk)("form",{onSubmit:t[8]||(t[8]=(0,o.D$)((...e)=>l.handleSubmit&&l.handleSubmit(...e),["prevent"])),class:"p-6 space-y-4"},[(0,a.Lk)("div",null,[t[11]||(t[11]=(0,a.Lk)("label",{for:"name",class:"block text-sm font-medium text-gray-700 mb-1"},"الاسم الكامل",-1)),(0,a.bo)((0,a.Lk)("input",{id:"name","onUpdate:modelValue":t[1]||(t[1]=e=>l.form.name=e),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل الاسم الكامل"},null,512),[[o.Jo,l.form.name]])]),(0,a.Lk)("div",null,[t[12]||(t[12]=(0,a.Lk)("label",{for:"email",class:"block text-sm font-medium text-gray-700 mb-1"},"البريد الإلكتروني",-1)),(0,a.bo)((0,a.Lk)("input",{id:"email","onUpdate:modelValue":t[2]||(t[2]=e=>l.form.email=e),type:"email",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"example@company.com"},null,512),[[o.Jo,l.form.email]])]),(0,a.Lk)("div",null,[t[13]||(t[13]=(0,a.Lk)("label",{for:"password",class:"block text-sm font-medium text-gray-700 mb-1"},"كلمة المرور",-1)),(0,a.bo)((0,a.Lk)("input",{id:"password","onUpdate:modelValue":t[3]||(t[3]=e=>l.form.password=e),type:"password",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"كلمة المرور المؤقتة"},null,512),[[o.Jo,l.form.password]])]),(0,a.Lk)("div",null,[t[15]||(t[15]=(0,a.Lk)("label",{for:"role",class:"block text-sm font-medium text-gray-700 mb-1"},"الدور",-1)),(0,a.bo)((0,a.Lk)("select",{id:"role","onUpdate:modelValue":t[4]||(t[4]=e=>l.form.role=e),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},[...t[14]||(t[14]=[(0,a.Lk)("option",{value:""},"اختر الدور",-1),(0,a.Lk)("option",{value:"company_manager"},"مدير الشركة",-1),(0,a.Lk)("option",{value:"warehouse_manager"},"مدير المخازن",-1)])],512),[[o.u1,l.form.role]])]),(0,a.Lk)("div",null,[t[16]||(t[16]=(0,a.Lk)("label",{for:"phone",class:"block text-sm font-medium text-gray-700 mb-1"},"رقم الهاتف",-1)),(0,a.bo)((0,a.Lk)("input",{id:"phone","onUpdate:modelValue":t[5]||(t[5]=e=>l.form.phone=e),type:"tel",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"01XXXXXXXXX"},null,512),[[o.Jo,l.form.phone]])]),(0,a.Lk)("div",null,[(0,a.Lk)("label",De,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>l.form.isActive=e),type:"checkbox",class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,512),[[o.lH,l.form.isActive]]),t[17]||(t[17]=(0,a.Lk)("span",{class:"text-sm text-gray-700"},"حساب نشط",-1))])]),l.error?((0,a.uX)(),(0,a.CE)("div",Pe,[(0,a.Lk)("p",Ae,(0,s.v_)(l.error),1)])):(0,a.Q3)("",!0),(0,a.Lk)("div",Se,[(0,a.Lk)("button",{type:"button",onClick:t[7]||(t[7]=t=>e.$emit("close")),class:"flex-1 px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors duration-200"}," إلغاء "),(0,a.Lk)("button",{type:"submit",disabled:l.loading,class:"flex-1 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200"},[l.loading?((0,a.uX)(),(0,a.CE)("span",Be,"جاري الإضافة...")):((0,a.uX)(),(0,a.CE)("span",Ke,"إضافة المستخدم"))],8,Re)])],32)])])):(0,a.Q3)("",!0)}var ze={name:"AddUserModal",props:{isOpen:{type:Boolean,default:!1}},emits:["close","success"],setup(e,{emit:t}){const r=(0,Me.Pj)(),s=(0,Ee.KR)(!1),o=(0,Ee.KR)(""),l=(0,Ee.Kh)({name:"",email:"",password:"",role:"",phone:"",isActive:!0});(0,a.wB)(()=>e.isOpen,e=>{e&&n()});const n=()=>{Object.assign(l,{name:"",email:"",password:"",role:"",phone:"",isActive:!0}),o.value=""},d=()=>{const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*";let t="";for(let r=0;r<12;r++)t+=e.charAt(Math.floor(Math.random()*e.length));l.password=t},i=async()=>{if(l.name&&l.email&&l.password&&l.role)if(l.password.length<6)o.value="كلمة المرور يجب أن تكون 6 أحرف على الأقل";else{s.value=!0,o.value="";try{const e={id:Date.now().toString(),name:l.name,email:l.email,role:l.role,phone:l.phone,isActive:l.isActive,createdAt:(new Date).toISOString(),createdBy:r.state.user?.uid||"system"};await r.dispatch("addUser",e),t("success"),t("close"),console.log("User added successfully:",e)}catch(e){console.error("Error adding user:",e),o.value="فشل في إضافة المستخدم. يرجى المحاولة مرة أخرى."}finally{s.value=!1}}else o.value="جميع الحقول المطلوبة يجب ملؤها"};return d(),{form:l,loading:s,error:o,handleSubmit:i,generatePassword:d}}},Ve=r(262);const Fe=(0,Ve.A)(ze,[["render",Ie],["__scopeId","data-v-345ebfc8"]]);var Qe=Fe,Te=r(22),$e=r(949),He={name:"Users",components:{AddUserModal:Qe,UserModal:Te.A,ResetPasswordModal:$e.A},setup(){const e=(0,Me.Pj)(),t=(0,Ee.KR)(!1),r=(0,Ee.KR)(""),s=(0,Ee.KR)(!1),o=(0,Ee.KR)(!1),l=(0,Ee.KR)(!1),n=(0,Ee.KR)(null),d=(0,Ee.KR)(""),i=(0,Ee.KR)(""),u=(0,Ee.KR)(""),c=(0,Ee.KR)(1),g=10,m=(0,Ee.KR)([]),p=(0,a.EW)(()=>e.state.user?.uid),k=(0,a.EW)(()=>e.state.operationLoading),x=(0,a.EW)(()=>{let e=[...m.value];if(d.value){const t=d.value.toLowerCase();e=e.filter(e=>e.name?.toLowerCase().includes(t)||e.email?.toLowerCase().includes(t)||e.phone?.toLowerCase().includes(t))}return i.value&&(e=e.filter(e=>e.role===i.value)),u.value&&("active"===u.value?e=e.filter(e=>!1!==e.is_active):"inactive"===u.value&&(e=e.filter(e=>!1===e.is_active))),e}),h=(0,a.EW)(()=>m.value.length),v=(0,a.EW)(()=>m.value.filter(e=>!1!==e.is_active).length),b=(0,a.EW)(()=>m.value.filter(e=>"warehouse_manager"===e.role).length),y=(0,a.EW)(()=>{const e=m.value.filter(e=>e.last_login).sort((e,t)=>new Date(t.last_login)-new Date(e.last_login))[0];return e?X(e.last_login):"لا يوجد"}),f=(0,a.EW)(()=>Math.ceil(x.value.length/g)),w=(0,a.EW)(()=>(c.value-1)*g),L=(0,a.EW)(()=>w.value+g),C=(0,a.EW)(()=>x.value.slice(w.value,L.value)),_=(0,a.EW)(()=>{const e=[],t=5;let r=Math.max(1,c.value-Math.floor(t/2)),a=Math.min(f.value,r+t-1);a-r+1<t&&(r=Math.max(1,a-t+1));for(let s=r;s<=a;s++)e.push(s);return e}),E=e=>new Intl.NumberFormat("ar-EG").format(e||0),M=e=>{if(!e)return"";const t=new Date(e);return t.toLocaleDateString("ar-EG",{year:"numeric",month:"long",day:"numeric"})},X=e=>{if(!e)return"";const t=new Date(e),r=new Date,a=r-t,s=Math.floor(a/6e4),o=Math.floor(s/60),l=Math.floor(o/24);return s<1?"الآن":s<60?`منذ ${s} دقيقة`:o<24?`منذ ${o} ساعة`:l<7?`منذ ${l} يوم`:M(e)},U=e=>e?e.split(" ").map(e=>e[0]).join("").toUpperCase().substring(0,2):"??",j=e=>{const t={superadmin:"المشرف العام",warehouse_manager:"مدير المخازن",company_manager:"مدير الشركة"};return t[e]||e},W=e=>{const t={superadmin:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gradient-to-r from-purple-500 to-pink-500 text-white",warehouse_manager:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gradient-to-r from-blue-500 to-cyan-500 text-white",company_manager:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gradient-to-r from-green-500 to-emerald-500 text-white"};return t[e]||"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-200 text-gray-800 dark:bg-gray-700 dark:text-gray-300"},D=e=>!1===e.is_active?"غير نشيط":"نشيط",P=e=>!1===e.is_active?"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300":"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",A=e=>!1===e.is_active?"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300":"text-orange-600 hover:text-orange-900 dark:text-orange-400 dark:hover:text-orange-300",S=()=>{c.value=1},R=()=>{c.value=1},B=async()=>{t.value=!0,r.value="";try{const t=await e.dispatch("loadAllUsers");m.value=t||[]}catch(a){r.value=a.message||"حدث خطأ في تحميل المستخدمين",m.value=q()}finally{t.value=!1}},K=e=>{n.value=e.id,o.value=!0},I=e=>{n.value=e.id,l.value=!0},z=async t=>{const r=!t.is_active,a=r?`هل تريد تفعيل المستخدم "${t.name}"؟`:`هل تريد تعطيل المستخدم "${t.name}"؟`;if(confirm(a))try{await e.dispatch("updateUser",{userId:t.id,userData:{is_active:r}}),alert(`تم ${r?"تفعيل":"تعطيل"} المستخدم بنجاح`),B()}catch(s){alert(s.message||"حدث خطأ في تحديث حالة المستخدم")}},V=async t=>{if(confirm(`هل أنت متأكد من حذف المستخدم "${t.name}"؟\nهذا الإجراء لا يمكن التراجع عنه.`))try{await e.dispatch("deleteUser",t.id),alert("تم حذف المستخدم بنجاح"),B()}catch(r){alert(r.message||"حدث خطأ في حذف المستخدم")}},F=()=>{s.value=!1,alert("تم إضافة المستخدم بنجاح"),B()},Q=()=>{o.value=!1,alert("تم تحديث المستخدم بنجاح"),B()},T=()=>{l.value=!1,alert("تم إعادة تعيين كلمة المرور بنجاح")},$=()=>{c.value>1&&c.value--},H=()=>{c.value<f.value&&c.value++},O=e=>{c.value=e},q=()=>[{id:"1",name:"المشرف العام",email:"superadmin@monofia.com",role:"superadmin",allowed_warehouses:["main_warehouse","tera_warehouse","shobeen_warehouse","hyper_warehouse"],is_active:!0,phone:"+201234567890",last_login:new Date("2024-01-15T10:30:00")},{id:"2",name:"مدير المخازن",email:"warehouse@monofia.com",role:"warehouse_manager",allowed_warehouses:["main_warehouse","tera_warehouse"],is_active:!0,phone:"+201112223344",last_login:new Date("2024-01-14T14:20:00")},{id:"3",name:"مدير الشركة",email:"company@monofia.com",role:"company_manager",allowed_warehouses:[],is_active:!0,phone:"+201556667788",last_login:new Date("2024-01-13T09:15:00")},{id:"4",name:"محمد أحمد",email:"mohamed@monofia.com",role:"warehouse_manager",allowed_warehouses:["shobeen_warehouse","hyper_warehouse"],is_active:!1,phone:"+201998887766",last_login:new Date("2023-12-20T11:45:00")}];return(0,a.sV)(()=>{B()}),{loading:t,error:r,showAddModal:s,showEditModal:o,showResetPasswordModal:l,selectedUserId:n,searchTerm:d,roleFilter:i,statusFilter:u,currentPage:c,users:m,currentUserId:p,operationLoading:k,filteredUsers:x,totalUsers:h,activeUsers:v,warehouseManagers:b,lastLoginTime:y,paginatedUsers:C,totalPages:f,startIndex:w,endIndex:L,visiblePages:_,formatNumber:E,formatDate:M,getUserInitials:U,getRoleText:j,getRoleBadgeClass:W,getStatusText:D,getStatusBadgeClass:P,getStatusButtonClass:A,handleSearch:S,handleFilter:R,refreshData:B,editUser:K,resetPassword:I,toggleUserStatus:z,deleteUser:V,handleUserAdded:F,handleUserUpdated:Q,handlePasswordReset:T,prevPage:$,nextPage:H,goToPage:O}}};const Oe=(0,Ve.A)(He,[["render",_e],["__scopeId","data-v-7d0eb434"]]);var qe=Oe},949:function(e,t,r){r.d(t,{A:function(){return j}});var a=r(641),s=r(751),o=r(33);const l={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},n={class:"bg-white rounded-lg w-full max-w-md rtl"},d={class:"flex justify-between items-center p-6 border-b border-gray-200"},i={key:0,class:"text-center"},u={class:"h-16 w-16 bg-indigo-100 rounded-full flex items-center justify-center mx-auto mb-3"},c={class:"text-indigo-600 font-medium text-lg"},g={class:"text-lg font-medium text-gray-900"},m={class:"text-sm text-gray-500 mt-1"},p={class:"mt-2"},k={key:1,class:"space-y-2"},x={class:"flex justify-between items-center"},h={class:"h-2 bg-gray-200 rounded-full overflow-hidden"},v={class:"text-xs text-gray-600 space-y-1 list-disc pr-5"},b={key:2,class:"bg-red-50 border border-red-200 rounded-md p-4"},y={class:"text-sm text-red-700"},f={class:"flex gap-3 pt-6 border-t border-gray-200"},w=["disabled"],L={key:0,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},C={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function _(e,t,r,_,E,M){return r.isOpen?((0,a.uX)(),(0,a.CE)("div",l,[(0,a.Lk)("div",n,[(0,a.Lk)("div",d,[t[6]||(t[6]=(0,a.Lk)("h2",{class:"text-xl font-semibold text-gray-800"},"إعادة تعيين كلمة المرور",-1)),(0,a.Lk)("button",{onClick:t[0]||(t[0]=t=>e.$emit("close")),class:"p-1 hover:bg-gray-100 rounded transition-colors duration-200"},[...t[5]||(t[5]=[(0,a.Lk)("svg",{class:"w-6 h-6 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),(0,a.Lk)("form",{onSubmit:t[4]||(t[4]=(0,s.D$)((...e)=>_.handleSubmit&&_.handleSubmit(...e),["prevent"])),class:"p-6 space-y-6"},[r.user?((0,a.uX)(),(0,a.CE)("div",i,[(0,a.Lk)("div",u,[(0,a.Lk)("span",c,(0,o.v_)(_.getUserInitials(r.user.name||r.user.email)),1)]),(0,a.Lk)("h3",g,(0,o.v_)(r.user.name||r.user.email),1),(0,a.Lk)("p",m,(0,o.v_)(r.user.email),1)])):(0,a.Q3)("",!0),(0,a.Lk)("div",null,[t[7]||(t[7]=(0,a.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[(0,a.eW)(" كلمة المرور الجديدة "),(0,a.Lk)("span",{class:"text-red-500"},"*")],-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",required:"","onUpdate:modelValue":t[1]||(t[1]=e=>_.newPassword=e),class:"w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-colors duration-200",placeholder:"أدخل كلمة المرور الجديدة"},null,512),[[s.Jo,_.newPassword]]),(0,a.Lk)("div",p,[(0,a.Lk)("button",{type:"button",onClick:t[2]||(t[2]=(...e)=>_.generatePassword&&_.generatePassword(...e)),class:"text-sm text-indigo-600 hover:text-indigo-800"}," توليد كلمة مرور عشوائية ")]),t[8]||(t[8]=(0,a.Lk)("p",{class:"text-xs text-gray-500 mt-2"}," يجب أن تكون كلمة المرور 6 أحرف على الأقل. سيتمكن المستخدم من تغييرها بعد الدخول. ",-1))]),_.newPassword?((0,a.uX)(),(0,a.CE)("div",k,[(0,a.Lk)("div",x,[t[9]||(t[9]=(0,a.Lk)("span",{class:"text-sm font-medium text-gray-700"},"قوة كلمة المرور:",-1)),(0,a.Lk)("span",{class:(0,o.C4)(["text-sm font-medium",_.passwordStrengthClass])},(0,o.v_)(_.passwordStrengthText),3)]),(0,a.Lk)("div",h,[(0,a.Lk)("div",{class:(0,o.C4)(["h-full transition-all duration-300",_.passwordStrengthClass]),style:(0,o.Tr)({width:_.passwordStrengthPercentage+"%"})},null,6)]),(0,a.Lk)("ul",v,[(0,a.Lk)("li",{class:(0,o.C4)(_.hasLength?"text-green-600":"")},"8 أحرف على الأقل",2),(0,a.Lk)("li",{class:(0,o.C4)(_.hasUppercase?"text-green-600":"")},"حرف كبير واحد على الأقل",2),(0,a.Lk)("li",{class:(0,o.C4)(_.hasLowercase?"text-green-600":"")},"حرف صغير واحد على الأقل",2),(0,a.Lk)("li",{class:(0,o.C4)(_.hasNumber?"text-green-600":"")},"رقم واحد على الأقل",2),(0,a.Lk)("li",{class:(0,o.C4)(_.hasSpecialChar?"text-green-600":"")},"رمز خاص واحد على الأقل",2)])])):(0,a.Q3)("",!0),_.errorMessage?((0,a.uX)(),(0,a.CE)("div",b,[(0,a.Lk)("p",y,(0,o.v_)(_.errorMessage),1)])):(0,a.Q3)("",!0),(0,a.Lk)("div",f,[(0,a.Lk)("button",{type:"button",onClick:t[3]||(t[3]=t=>e.$emit("close")),class:"flex-1 py-3 px-4 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors duration-200 font-medium"}," إلغاء "),(0,a.Lk)("button",{type:"submit",disabled:_.loading||!_.isFormValid,class:"flex-1 py-3 px-4 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200 font-medium flex items-center justify-center gap-2"},[_.loading?((0,a.uX)(),(0,a.CE)("svg",L,[...t[10]||(t[10]=[(0,a.Lk)("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),(0,a.Lk)("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):((0,a.uX)(),(0,a.CE)("svg",C,[...t[11]||(t[11]=[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"},null,-1)])])),(0,a.eW)(" "+(0,o.v_)(_.loading?"جاري التحديث...":"تحديث كلمة المرور"),1)],8,w)])],32)])])):(0,a.Q3)("",!0)}var E=r(953),M={name:"ResetPasswordModal",props:{isOpen:{type:Boolean,required:!0},user:{type:Object,default:null}},emits:["close","reset"],setup(e,{emit:t}){const r=(0,E.KR)(!1),s=(0,E.KR)(""),o=(0,E.KR)(""),l=(0,a.EW)(()=>{if(!o.value)return 0;let e=0;const t=o.value;return t.length>=8&&(e+=20),/[A-Z]/.test(t)&&(e+=20),/[a-z]/.test(t)&&(e+=20),/[0-9]/.test(t)&&(e+=20),/[^A-Za-z0-9]/.test(t)&&(e+=20),e}),n=(0,a.EW)(()=>Math.min(l.value,100)),d=(0,a.EW)(()=>{const e=l.value;return e<40?"ضعيفة":e<60?"متوسطة":e<80?"جيدة":"قوية جداً"}),i=(0,a.EW)(()=>{const e=l.value;return e<40?"bg-red-500 text-red-500":e<60?"bg-yellow-500 text-yellow-500":e<80?"bg-blue-500 text-blue-500":"bg-green-500 text-green-500"}),u=(0,a.EW)(()=>o.value.length>=8),c=(0,a.EW)(()=>/[A-Z]/.test(o.value)),g=(0,a.EW)(()=>/[a-z]/.test(o.value)),m=(0,a.EW)(()=>/[0-9]/.test(o.value)),p=(0,a.EW)(()=>/[^A-Za-z0-9]/.test(o.value)),k=(0,a.EW)(()=>o.value.length>=6),x=e=>e?e.split(" ").map(e=>e[0]).join("").toUpperCase().substring(0,2):"?",h=()=>{const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*";let t="";for(let r=0;r<12;r++)t+=e.charAt(Math.floor(Math.random()*e.length));o.value=t},v=()=>{o.value="",s.value="",r.value=!1},b=async()=>{if(k.value&&e.user){r.value=!0,s.value="";try{t("reset",{userId:e.user.id,newPassword:o.value})}catch(a){console.error("Error in password reset:",a),s.value=a.message||"حدث خطأ أثناء إعادة تعيين كلمة المرور"}finally{r.value=!1}}};return(0,a.wB)(()=>e.isOpen,e=>{e&&(v(),h())}),{loading:r,errorMessage:s,newPassword:o,passwordStrengthPercentage:n,passwordStrengthText:d,passwordStrengthClass:i,hasLength:u,hasUppercase:c,hasLowercase:g,hasNumber:m,hasSpecialChar:p,isFormValid:k,getUserInitials:x,generatePassword:h,handleSubmit:b}}},X=r(262);const U=(0,X.A)(M,[["render",_]]);var j=U}}]);