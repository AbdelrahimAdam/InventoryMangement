"use strict";(self["webpackChunkmonofia_perfume_inventory"]=self["webpackChunkmonofia_perfume_inventory"]||[]).push([[727],{727:function(e,r,a){a.d(r,{A:function(){return R}});var t=a(641),o=a(33),l=a(751);const s={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},n={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-lg rtl max-h-[90vh] overflow-y-auto"},i={class:"flex justify-between items-center p-6 border-b border-gray-200 dark:border-gray-700"},d={class:"text-xl font-semibold text-gray-800 dark:text-white"},u=["readonly"],c={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},m=["value","onUpdate:modelValue"],g={class:"flex w-full items-center justify-between"},p={class:"flex items-center"},b={class:"text-sm"},k={class:"font-medium text-gray-900 dark:text-white"},y={class:"text-gray-500 dark:text-gray-400 text-xs mt-1"},f={key:0,class:"h-5 w-5 text-blue-600 dark:text-blue-400",viewBox:"0 0 20 20",fill:"currentColor"},x={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},v={class:"relative"},h={class:"relative inline-flex items-center cursor-pointer"},w={class:"mr-3 text-sm font-medium text-gray-700 dark:text-gray-300"},L={key:0},_={class:"flex items-center"},D={key:1,class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md p-4"},C={class:"text-sm text-red-700 dark:text-red-300 list-disc pr-5 space-y-1"},E={key:2,class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md p-4"},M={class:"flex items-center gap-2"},V={class:"text-sm text-red-700 dark:text-red-300"},X={class:"flex gap-3 pt-6 border-t border-gray-200 dark:border-gray-700"},U=["disabled"],j={key:0,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},B={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function W(e,r,a,W,S,z){return a.isOpen?((0,t.uX)(),(0,t.CE)("div",s,[(0,t.Lk)("div",n,[(0,t.Lk)("div",i,[(0,t.Lk)("h2",d,(0,o.v_)(a.warehouse?"تعديل المخزن":"إضافة مخزن جديد"),1),(0,t.Lk)("button",{onClick:r[0]||(r[0]=(...e)=>W.closeModal&&W.closeModal(...e)),class:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors duration-200"},[...r[11]||(r[11]=[(0,t.Lk)("svg",{class:"w-6 h-6 text-gray-500 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,t.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),(0,t.Lk)("form",{onSubmit:r[10]||(r[10]=(0,l.D$)((...e)=>W.handleSubmit&&W.handleSubmit(...e),["prevent"])),class:"p-6 space-y-6"},[(0,t.Lk)("div",null,[r[12]||(r[12]=(0,t.Lk)("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[(0,t.eW)(" معرف المخزن "),(0,t.Lk)("span",{class:"text-red-500"},"*"),(0,t.Lk)("span",{class:"text-xs text-gray-500 dark:text-gray-400 block mt-1"},"يجب أن يكون معرفاً فريداً بالإنجليزية")],-1)),(0,t.bo)((0,t.Lk)("input",{type:"text",required:"","onUpdate:modelValue":r[1]||(r[1]=e=>W.formData.id=e),readonly:!!a.warehouse,class:(0,o.C4)(["w-full p-3 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 bg-white dark:bg-gray-700 text-gray-900 dark:text-white font-mono",{"bg-gray-100 dark:bg-gray-800":!!a.warehouse}]),placeholder:"مثال: main_warehouse"},null,10,u),[[l.Jo,W.formData.id]])]),(0,t.Lk)("div",null,[r[13]||(r[13]=(0,t.Lk)("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[(0,t.eW)(" اسم المخزن (عربي) "),(0,t.Lk)("span",{class:"text-red-500"},"*")],-1)),(0,t.bo)((0,t.Lk)("input",{type:"text",required:"","onUpdate:modelValue":r[2]||(r[2]=e=>W.formData.name_ar=e),class:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-right",placeholder:"مخزن رئيسي"},null,512),[[l.Jo,W.formData.name_ar]])]),(0,t.Lk)("div",null,[r[14]||(r[14]=(0,t.Lk)("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," اسم المخزن (إنجليزي) ",-1)),(0,t.bo)((0,t.Lk)("input",{type:"text","onUpdate:modelValue":r[3]||(r[3]=e=>W.formData.name_en=e),class:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Main Warehouse"},null,512),[[l.Jo,W.formData.name_en]])]),(0,t.Lk)("div",null,[r[16]||(r[16]=(0,t.Lk)("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},[(0,t.eW)(" نوع المخزن "),(0,t.Lk)("span",{class:"text-red-500"},"*")],-1)),(0,t.Lk)("div",c,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(W.warehouseTypes,e=>((0,t.uX)(),(0,t.CE)("label",{key:e.value,class:(0,o.C4)(["relative flex cursor-pointer rounded-lg border p-4 focus:outline-none transition-colors duration-200",{"border-blue-600 dark:border-blue-500 bg-blue-50 dark:bg-blue-900/20":W.formData.type===e.value,"border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700":W.formData.type!==e.value}])},[(0,t.bo)((0,t.Lk)("input",{type:"radio",value:e.value,"onUpdate:modelValue":e=>W.formData.type=e,class:"sr-only"},null,8,m),[[l.XL,W.formData.type]]),(0,t.Lk)("div",g,[(0,t.Lk)("div",p,[(0,t.Lk)("div",b,[(0,t.Lk)("div",k,(0,o.v_)(e.name),1),(0,t.Lk)("div",y,(0,o.v_)(e.description),1)])]),W.formData.type===e.value?((0,t.uX)(),(0,t.CE)("svg",f,[...r[15]||(r[15]=[(0,t.Lk)("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)])])):(0,t.Q3)("",!0)])],2))),128))])]),(0,t.Lk)("div",x,[(0,t.Lk)("div",null,[r[18]||(r[18]=(0,t.Lk)("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," السعة التخزينية ",-1)),(0,t.Lk)("div",v,[(0,t.bo)((0,t.Lk)("input",{type:"number","onUpdate:modelValue":r[4]||(r[4]=e=>W.formData.capacity=e),min:"0",step:"1",class:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 bg-white dark:bg-gray-700 text-gray-900 dark:text-white pr-10",placeholder:"1000"},null,512),[[l.Jo,W.formData.capacity,void 0,{number:!0}]]),r[17]||(r[17]=(0,t.Lk)("span",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-gray-400"},"وحدة",-1))])]),(0,t.Lk)("div",null,[r[19]||(r[19]=(0,t.Lk)("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," الموقع ",-1)),(0,t.bo)((0,t.Lk)("input",{type:"text","onUpdate:modelValue":r[5]||(r[5]=e=>W.formData.location=e),class:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"شارع الشيخ، المنوفية"},null,512),[[l.Jo,W.formData.location]])])]),(0,t.Lk)("div",null,[r[20]||(r[20]=(0,t.Lk)("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," وصف المخزن ",-1)),(0,t.bo)((0,t.Lk)("textarea",{"onUpdate:modelValue":r[6]||(r[6]=e=>W.formData.description=e),rows:"3",class:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"وصف إضافي للمخزن..."},null,512),[[l.Jo,W.formData.description]])]),(0,t.Lk)("div",null,[r[22]||(r[22]=(0,t.Lk)("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},"حالة المخزن",-1)),(0,t.Lk)("label",h,[(0,t.bo)((0,t.Lk)("input",{type:"checkbox","onUpdate:modelValue":r[7]||(r[7]=e=>W.formData.status=e),"true-value":"active","false-value":"inactive",class:"sr-only peer"},null,512),[[l.lH,W.formData.status]]),r[21]||(r[21]=(0,t.Lk)("div",{class:"w-11 h-6 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:right-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"},null,-1)),(0,t.Lk)("span",w,(0,o.v_)("active"===W.formData.status?"نشط":"غير نشط"),1)])]),"primary"===W.formData.type?((0,t.uX)(),(0,t.CE)("div",L,[(0,t.Lk)("div",_,[(0,t.bo)((0,t.Lk)("input",{type:"checkbox","onUpdate:modelValue":r[8]||(r[8]=e=>W.formData.is_main=e),"true-value":!0,"false-value":!1,id:"is_main",class:"h-4 w-4 text-blue-600 dark:text-blue-400 border-gray-300 dark:border-gray-600 rounded focus:ring-blue-500 dark:focus:ring-blue-400"},null,512),[[l.lH,W.formData.is_main]]),r[23]||(r[23]=(0,t.Lk)("label",{for:"is_main",class:"mr-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," تعيين كمخزن رئيسي ",-1))]),r[24]||(r[24]=(0,t.Lk)("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"}," المخزن الرئيسي هو المخزن الافتراضي في النظام ",-1))])):(0,t.Q3)("",!0),W.validationErrors.length>0?((0,t.uX)(),(0,t.CE)("div",D,[r[25]||(r[25]=(0,t.Lk)("h4",{class:"text-sm font-medium text-red-800 dark:text-red-300 mb-2"},"خطأ في التحقق:",-1)),(0,t.Lk)("ul",C,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(W.validationErrors,e=>((0,t.uX)(),(0,t.CE)("li",{key:e},(0,o.v_)(e),1))),128))])])):(0,t.Q3)("",!0),W.errorMessage?((0,t.uX)(),(0,t.CE)("div",E,[(0,t.Lk)("div",M,[r[26]||(r[26]=(0,t.Lk)("svg",{class:"w-5 h-5 text-red-500 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,t.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),(0,t.Lk)("p",V,(0,o.v_)(W.errorMessage),1)])])):(0,t.Q3)("",!0),(0,t.Lk)("div",X,[(0,t.Lk)("button",{type:"button",onClick:r[9]||(r[9]=(...e)=>W.closeModal&&W.closeModal(...e)),class:"flex-1 py-3 px-4 border border-gray-300 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200 font-medium"}," إلغاء "),(0,t.Lk)("button",{type:"submit",disabled:W.loading||!W.isFormValid,class:"flex-1 py-3 px-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-md hover:from-blue-700 hover:to-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200 font-medium flex items-center justify-center gap-2"},[W.loading?((0,t.uX)(),(0,t.CE)("svg",j,[...r[27]||(r[27]=[(0,t.Lk)("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),(0,t.Lk)("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):((0,t.uX)(),(0,t.CE)("svg",B,[...r[28]||(r[28]=[(0,t.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])),(0,t.eW)(" "+(0,o.v_)(W.loading?"جاري الحفظ...":a.warehouse?"تحديث":"إضافة"),1)],8,U)])],32)])])):(0,t.Q3)("",!0)}var S=a(953),z=a(278),K=a(556),J=a(884),O={name:"WarehouseModal",props:{isOpen:{type:Boolean,required:!0},warehouse:{type:Object,default:null}},emits:["close","save"],setup(e,{emit:r}){const a=(0,z.Pj)(),o=(0,S.KR)(!1),l=(0,S.KR)(""),s=(0,S.KR)([]),n=(0,S.KR)({id:"",name_ar:"",name_en:"",type:"primary",capacity:0,location:"",description:"",status:"active",is_main:!1}),i=(0,S.KR)([{value:"primary",name:"مخزن رئيسي",description:"مخزن للتخزين الداخلي"},{value:"dispatch",name:"موقع صرف",description:"موقع لصرف الأصناف للخارج"}]),d=(0,t.EW)(()=>(s.value=[],n.value.id.trim()?/^[a-z0-9_]+$/.test(n.value.id)||s.value.push("معرف المخزن يجب أن يحتوي على أحرف إنجليزية صغيرة وأرقام وشرطة سفلية فقط"):s.value.push("معرف المخزن مطلوب"),n.value.name_ar.trim()||s.value.push("اسم المخزن بالعربي مطلوب"),n.value.type||s.value.push("نوع المخزن مطلوب"),n.value.capacity<0&&s.value.push("السعة التخزينية لا يمكن أن تكون سالبة"),0===s.value.length)),u=()=>{n.value={id:"",name_ar:"",name_en:"",type:"primary",capacity:0,location:"",description:"",status:"active",is_main:!1},l.value="",s.value=[]},c=()=>{u(),r("close")},m=async e=>{try{const r=(0,J.H9)(K.db,"warehouses",e),a=await(0,J.x7)(r);return a.exists()}catch(r){return console.error("Error checking warehouse existence:",r),!1}},g=async()=>{if(d.value){o.value=!0,l.value="";try{const t={id:n.value.id.trim(),name_ar:n.value.name_ar.trim(),name_en:n.value.name_en.trim()||n.value.name_ar.trim(),type:n.value.type,capacity:Number(n.value.capacity)||0,location:n.value.location.trim(),description:n.value.description.trim(),status:n.value.status,is_main:n.value.is_main||!1,updated_at:(new Date).toISOString()};if(e.warehouse)t.created_at=e.warehouse.created_at;else{const e=await m(t.id);if(e)throw new Error("المخزن موجود بالفعل");t.created_at=(new Date).toISOString()}if(!a.getters.canManageWarehouses)throw new Error("ليس لديك صلاحية لإدارة المخازن");const o=(0,J.H9)(K.db,"warehouses",t.id);await(0,J.BN)(o,t,{merge:!0}),console.log("Warehouse saved successfully:",t.id),a.dispatch("showNotification",{type:"success",message:`تم ${e.warehouse?"تحديث":"إضافة"} المخزن "${t.name_ar}" بنجاح`}),r("save",t),c()}catch(t){console.error("Error saving warehouse:",t),l.value=t.message||"حدث خطأ أثناء حفظ المخزن",a.dispatch("showNotification",{type:"error",message:l.value})}finally{o.value=!1}}};return(0,t.wB)(()=>e.isOpen,r=>{r&&(u(),e.warehouse&&(n.value={id:e.warehouse.id,name_ar:e.warehouse.name_ar||"",name_en:e.warehouse.name_en||"",type:e.warehouse.type||"primary",capacity:e.warehouse.capacity||0,location:e.warehouse.location||"",description:e.warehouse.description||"",status:e.warehouse.status||"active",is_main:e.warehouse.is_main||!1}))}),(0,t.wB)(()=>n.value.type,e=>{"dispatch"===e&&(n.value.is_main=!1)}),{loading:o,errorMessage:l,validationErrors:s,formData:n,warehouseTypes:i,isFormValid:d,closeModal:c,handleSubmit:g}}},H=a(262);const Q=(0,H.A)(O,[["render",W]]);var R=Q}}]);