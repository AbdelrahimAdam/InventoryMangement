"use strict";(self["webpackChunkmonofia_perfume_inventory"]=self["webpackChunkmonofia_perfume_inventory"]||[]).push([[849],{6822:function(e,o,t){t.d(o,{A:function(){return G}});var s=t(641),l=t(33);const n={key:0,class:"firebase-loading-screen"},a={class:"loading-content"},i={class:"loading-details"},r={class:"text-sm opacity-70"},c={key:0,class:"error-retry"},u={key:1},d={key:0,class:"mobile-scroll-container"},v={key:1,class:"desktop-scroll-container"},k={key:2,class:"global-toast"},g={class:"toast-icon"},m={key:0,class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},h={key:1,class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},p={key:2,class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},L={key:3,class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},f={class:"toast-message"},w={key:3,class:"dev-tools"},y={key:0,class:"dev-tools-panel"},E={class:"dev-tools-header"},b={class:"dev-tools-content"},R={class:"info-grid"},C={class:"info-item"},T={class:"info-item"},_={class:"value"},S={class:"info-item"},A={class:"value"},D={class:"info-item"},M={class:"value"},U={class:"info-item"},x={class:"value"},K={class:"action-buttons"},z={class:"firebase-info"},P={class:"text-xs"},X={key:4,class:"network-status offline"},F={key:5,class:"network-status online"};function I(e,o,t,I,N,j){const B=(0,s.g2)("MobileDashboard"),O=(0,s.g2)("DesktopLayout"),Q=(0,s.g2)("router-view");return(0,s.uX)(),(0,s.CE)(s.FK,null,[I.initializing?((0,s.uX)(),(0,s.CE)("div",n,[(0,s.Lk)("div",a,[o[10]||(o[10]=(0,s.Lk)("div",{class:"firebase-spinner"},null,-1)),o[11]||(o[11]=(0,s.Lk)("h1",null,"Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø²Ù†",-1)),o[12]||(o[12]=(0,s.Lk)("p",null,"Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…...",-1)),o[13]||(o[13]=(0,s.Lk)("div",{class:"loading-progress"},[(0,s.Lk)("div",{class:"progress-bar"})],-1)),(0,s.Lk)("div",i,[(0,s.Lk)("p",r,(0,l.v_)(I.loadingMessage),1),o[9]||(o[9]=(0,s.Lk)("p",{class:"text-xs opacity-50 mt-2"},"Ø§Ù„Ø¥ØµØ¯Ø§Ø± 1.0.0",-1))])]),I.showRetryButton?((0,s.uX)(),(0,s.CE)("div",c,[(0,s.Lk)("button",{onClick:o[0]||(o[0]=(...e)=>I.retryInitialization&&I.retryInitialization(...e)),class:"retry-btn"}," ðŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© "),(0,s.Lk)("button",{onClick:o[1]||(o[1]=(...e)=>I.forceLoginPage&&I.forceLoginPage(...e)),class:"force-login-btn"}," ðŸ”“ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙŠØ¯ÙˆÙŠØ§Ù‹ ")])):(0,s.Q3)("",!0)])):((0,s.uX)(),(0,s.CE)("div",u,[I.isAuthenticated&&I.userProfile?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[I.isMobile?((0,s.uX)(),(0,s.CE)("div",d,[(0,s.bF)(B)])):((0,s.uX)(),(0,s.CE)("div",v,[(0,s.bF)(O)]))],64)):((0,s.uX)(),(0,s.Wv)(Q,{key:1}))])),I.toast.show?((0,s.uX)(),(0,s.CE)("div",k,[(0,s.Lk)("div",{class:(0,l.C4)(["toast-content",I.toast.type])},[(0,s.Lk)("div",g,["success"===I.toast.type?((0,s.uX)(),(0,s.CE)("svg",m,[...o[14]||(o[14]=[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])])):(0,s.Q3)("",!0),"error"===I.toast.type?((0,s.uX)(),(0,s.CE)("svg",h,[...o[15]||(o[15]=[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])])):(0,s.Q3)("",!0),"warning"===I.toast.type?((0,s.uX)(),(0,s.CE)("svg",p,[...o[16]||(o[16]=[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.346 16.5c-.77.833.192 2.5 1.732 2.5z"},null,-1)])])):(0,s.Q3)("",!0),"info"===I.toast.type?((0,s.uX)(),(0,s.CE)("svg",L,[...o[17]||(o[17]=[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])])):(0,s.Q3)("",!0)]),(0,s.Lk)("span",f,(0,l.v_)(I.toast.message),1),(0,s.Lk)("button",{onClick:o[2]||(o[2]=(...e)=>I.hideToast&&I.hideToast(...e)),class:"toast-close"},[...o[18]||(o[18]=[(0,s.Lk)("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])],2)])):(0,s.Q3)("",!0),I.isDevelopment&&!I.initializing&&I.isAuthenticated?((0,s.uX)(),(0,s.CE)("div",w,[(0,s.Lk)("button",{onClick:o[3]||(o[3]=(...e)=>I.toggleDevTools&&I.toggleDevTools(...e)),class:"dev-tools-toggle"},[...o[19]||(o[19]=[(0,s.Lk)("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})],-1)])]),I.showDevTools?((0,s.uX)(),(0,s.CE)("div",y,[(0,s.Lk)("div",E,[o[20]||(o[20]=(0,s.Lk)("h3",null,"ðŸ› ï¸ Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ·ÙˆÙŠØ±",-1)),(0,s.Lk)("button",{onClick:o[4]||(o[4]=(...e)=>I.toggleDevTools&&I.toggleDevTools(...e)),class:"close-btn"},"âœ•")]),(0,s.Lk)("div",b,[(0,s.Lk)("div",R,[(0,s.Lk)("div",C,[o[21]||(o[21]=(0,s.Lk)("span",{class:"label"},"Ø§Ù„Ø­Ø§Ù„Ø©:",-1)),(0,s.Lk)("span",{class:(0,l.C4)(["value",I.isAuthenticated?"text-green-500":"text-red-500"])},(0,l.v_)(I.isAuthenticated?"Ù…Ø³Ø¬Ù„":"ØºÙŠØ± Ù…Ø³Ø¬Ù„"),3)]),(0,s.Lk)("div",T,[o[22]||(o[22]=(0,s.Lk)("span",{class:"label"},"Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:",-1)),(0,s.Lk)("span",_,(0,l.v_)(I.userName||"---"),1)]),(0,s.Lk)("div",S,[o[23]||(o[23]=(0,s.Lk)("span",{class:"label"},"Ø§Ù„Ø¯ÙˆØ±:",-1)),(0,s.Lk)("span",A,(0,l.v_)(I.userRole||"---"),1)]),(0,s.Lk)("div",D,[o[24]||(o[24]=(0,s.Lk)("span",{class:"label"},"Ø§Ù„Ù…Ø³Ø§Ø±:",-1)),(0,s.Lk)("span",M,(0,l.v_)(I.currentRoutePath),1)]),(0,s.Lk)("div",U,[o[25]||(o[25]=(0,s.Lk)("span",{class:"label"},"Ø§Ù„Ø¬ÙˆØ§Ù„:",-1)),(0,s.Lk)("span",x,(0,l.v_)(I.isMobile?"Ù†Ø¹Ù…":"Ù„Ø§"),1)])]),(0,s.Lk)("div",K,[(0,s.Lk)("button",{onClick:o[5]||(o[5]=(...e)=>I.forceLogout&&I.forceLogout(...e)),class:"action-btn logout-btn"}," ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ "),(0,s.Lk)("button",{onClick:o[6]||(o[6]=(...e)=>I.clearAllData&&I.clearAllData(...e)),class:"action-btn clear-btn"}," Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„ "),(0,s.Lk)("button",{onClick:o[7]||(o[7]=(...e)=>I.simulateSuperadmin&&I.simulateSuperadmin(...e)),class:"action-btn admin-btn"}," Ù…Ø­Ø§ÙƒØ§Ø© Ù…Ø´Ø±Ù "),(0,s.Lk)("button",{onClick:o[8]||(o[8]=(...e)=>I.refreshAllData&&I.refreshAllData(...e)),class:"action-btn refresh-btn"}," ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ")]),(0,s.Lk)("div",z,[o[26]||(o[26]=(0,s.Lk)("h4",null,"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Firebase:",-1)),(0,s.Lk)("p",P,(0,l.v_)(I.firebaseUserInfo),1)])])])):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0),I.isOnline?I.isOnline&&I.networkRestored?((0,s.uX)(),(0,s.CE)("div",F,[...o[28]||(o[28]=[(0,s.Lk)("div",{class:"flex items-center"},[(0,s.Lk)("svg",{class:"h-4 w-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),(0,s.Lk)("span",null,"ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø§ØªØµØ§Ù„")],-1)])])):(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",X,[...o[27]||(o[27]=[(0,s.Lk)("div",{class:"flex items-center"},[(0,s.Lk)("svg",{class:"h-4 w-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,s.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),(0,s.Lk)("span",null,"Ø£Ù†Øª ØºÙŠØ± Ù…ØªØµÙ„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª")],-1)])]))],64)}var N=t(953),j=t(834),B=t(5499),O=t(9890),Q=t(3613),W=t(3556),$=t(1032),q={name:"App",components:{MobileLayout:O.A,DesktopLayout:Q.A},setup(){const e=(0,j.Pj)(),o=(0,B.rd)(),t=(0,B.lq)(),l=(0,N.KR)(!0),n=(0,N.KR)(!1),a=(0,N.KR)(!1),i=(0,N.KR)(navigator.onLine),r=(0,N.KR)(!1),c=(0,N.KR)(!1),u=(0,N.KR)("Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©..."),d=(0,N.KR)(!1),v=(0,N.KR)({show:!1,message:"",type:"info"}),k=(0,N.KR)(!1),g=(0,s.EW)(()=>e.getters.isAuthenticated),m=(0,s.EW)(()=>e.state.userProfile),h=(0,s.EW)(()=>e.getters.userName),p=(0,s.EW)(()=>e.getters.userRole),L=(0,s.EW)(()=>t.path),f=(0,s.EW)(()=>{const e=W.j2.currentUser;return e?`Ø§Ù„Ø¨Ø±ÙŠØ¯: ${e.email} | UID: ${e.uid.substring(0,8)}...`:"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Firebase"}),w=(e,o="info",t=3e3)=>{v.value={show:!0,message:e,type:o},t>0&&setTimeout(()=>{v.value.message===e&&(v.value.show=!1)},t)},y=()=>{v.value.show=!1},E=()=>{const e=window.innerWidth;n.value=e<1024,document.body.classList.toggle("is-mobile",n.value),document.body.classList.toggle("is-desktop",!n.value)},b=()=>new Promise((o,t)=>{console.log("ðŸ” Starting Firebase authentication...");const s=setTimeout(()=>{console.warn("âš ï¸ Firebase auth timeout - proceeding without auth"),c.value=!0,o(null)},1e4),l=(0,$.hg)(W.j2,async t=>{if(clearTimeout(s),l(),console.log("âœ… Firebase auth state changed:",t?t.email:"No user"),d.value=!0,t)try{e.commit("SET_USER",t),u.value="Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…...",await e.dispatch("loadUserProfile",t),console.log("âœ… User authenticated:",t.email),w(`Ù…Ø±Ø­Ø¨Ø§Ù‹ ${e.getters.userName}!`,"success"),o(t)}catch(n){console.error("âŒ Failed to load user profile:",n),e.commit("SET_USER",null),w("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…","error"),o(null)}else e.commit("SET_USER",null),e.commit("SET_USER_PROFILE",null),console.log("ðŸ‘¤ No user authenticated"),o(null)},e=>{clearTimeout(s),l(),console.error("âŒ Firebase auth error:",e),d.value=!1,c.value=!0,w("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©","error"),t(e)})}),R=()=>(console.log("ðŸ”„ Auth routing check:",{isAuthenticated:g.value,hasProfile:!!m.value,currentRoute:t.path,routeName:t.name}),"/login"===t.path&&g.value&&m.value?(console.log("âœ… Already authenticated, redirecting to dashboard"),void o.replace("/dashboard")):t.meta?.requiresAuth&&!g.value&&"/login"!==t.path?(console.log("ðŸ”’ Not authenticated, redirecting to login"),void o.replace("/login")):g.value&&!1===m.value?.is_active?(console.log("ðŸš« User inactive, logging out"),e.dispatch("logout"),void o.replace("/login")):void 0),C=async()=>{console.log("ðŸš€ Starting app initialization...");try{E(),window.addEventListener("resize",E),u.value="Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©...",await b(),(0,$.hg)(W.j2,t=>{console.log("ðŸ‘ï¸ Auth state changed:",t?t.email:"No user"),!t&&g.value&&(console.log("ðŸ‘‹ User signed out, redirecting to login"),e.commit("SET_USER",null),e.commit("SET_USER_PROFILE",null),o.replace("/login"))}),R(),(0,s.wB)(g,R),(0,s.wB)(()=>t.path,()=>{setTimeout(R,100)}),console.log("âœ… App initialized successfully")}catch(n){console.error("âŒ App initialization failed:",n),w("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚","error"),"/login"!==t.path&&o.replace("/login"),c.value=!0}finally{setTimeout(()=>{l.value=!1,console.log("ðŸ App ready")},500)}},T=async()=>{c.value=!1,l.value=!0,u.value="Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©...",localStorage.removeItem("firebase:authUser:monofia-inventory"),sessionStorage.clear(),setTimeout(async()=>{await C()},1e3)},_=()=>{e.commit("SET_USER",null),e.commit("SET_USER_PROFILE",null),l.value=!1,o.replace("/login")},S=()=>{a.value=!a.value},A=async()=>{try{await e.dispatch("logout"),w("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬","success"),o.replace("/login")}catch(t){console.error("Logout error:",t),w("Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬","error")}},D=()=>{try{localStorage.clear(),sessionStorage.clear(),e.commit("SET_USER",null),e.commit("SET_USER_PROFILE",null),e.commit("SET_INVENTORY",[]),e.commit("SET_RECENT_TRANSACTIONS",[]),W.j2.signOut(),w("ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª","success"),setTimeout(()=>{window.location.href="/"},1e3)}catch(o){console.error("Clear data error:",o),w("Ø®Ø·Ø£ ÙÙŠ Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª","error")}},M=()=>{e.commit("SET_USER_PROFILE",{role:"superadmin",name:"Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø¹Ø§Ù…",email:"admin@example.com",is_active:!0,permissions:["full_access"],allowed_warehouses:["all"]}),w("ØªÙ… ØªØ¹ÙŠÙŠÙ†Ùƒ ÙƒÙ…Ø´Ø±Ù Ø¹Ø§Ù…","success")},U=async()=>{try{g.value&&(await e.dispatch("getRecentTransactions"),w("ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª","success"))}catch(o){console.error("Refresh error:",o),w("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª","error")}},x=()=>{const e=i.value;i.value=navigator.onLine,!e&&i.value?(r.value=!0,w("ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª","success",2e3),setTimeout(()=>r.value=!1,3e3)):e&&!i.value&&w("ÙÙ‚Ø¯Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª","warning",0)},K=e=>{e.ctrlKey&&e.shiftKey&&"D"===e.key&&(e.preventDefault(),S()),e.ctrlKey&&e.shiftKey&&"L"===e.key&&(e.preventDefault(),A()),e.ctrlKey&&e.shiftKey&&"R"===e.key&&(e.preventDefault(),U())},z=()=>{!document.hidden&&g.value&&(console.log("App became visible, refreshing data..."),U())};return(0,s.sV)(async()=>{console.log("ðŸ“± App component mounted"),window.addEventListener("online",x),window.addEventListener("offline",x),document.addEventListener("keydown",K),document.addEventListener("visibilitychange",z),await C()}),(0,s.hi)(()=>{console.log("ðŸ‘‹ App component unmounted"),window.removeEventListener("resize",E),window.removeEventListener("online",x),window.removeEventListener("offline",x),document.removeEventListener("keydown",K),document.removeEventListener("visibilitychange",z)}),{initializing:l,isMobile:n,toast:v,isDevelopment:k,showDevTools:a,isOnline:i,networkRestored:r,showRetryButton:c,loadingMessage:u,isAuthenticated:g,userProfile:m,userName:h,userRole:p,currentRoutePath:L,firebaseUserInfo:f,hideToast:y,toggleDevTools:S,forceLogout:A,clearAllData:D,simulateSuperadmin:M,refreshAllData:U,retryInitialization:T,forceLoginPage:_}}},V=t(6262);const Y=(0,V.A)(q,[["render",I],["__scopeId","data-v-b873a464"]]);var G=Y}}]);